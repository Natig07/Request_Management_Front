<main class="h-fit py-4 flex flex-col gap-y-5">
    <h1 class="w-full text-xl font-semibold">Profil</h1>

    <section class="profil-photo w-1/2 flex  justify-items-start flex-col gap-y-0.5 justify-center">
        <img [src]="photoUrl" loading="lazy" height="150" width="150" class="h-32 w-fit object-cover" alt="Profile Photo">
        <div class="flex w-fit gap-3">
            <div class=" py-2 px-1 w-fit">
              @if (selectedFileName!='') {
                <span class="text-sm text-[#6045E2]">
                Uploaded Image: {{selectedFileName}}
              </span>
              }
              
              <input type="file" name="file_input" id="file_inpt" class="hidden" (change)="onFileSelected($event)">
              <label for="file_inpt" class="cursor-pointer hover:opacity-100 opacity-80">
                <i class="text-[#9789de] bi bi-pencil-fill mx-1.5 text-[12px]">
              </i>
              <span class="text-[#6045E2] text-sm   ">Şəkli dəyiş</span>
              </label>
              
            </div>
            
            <button (click)="onFileDelete()" class="cursor-pointer  hover:opacity-100 opacity-80 py-2 px-1 w-fit"><i class="text-[#9789de] bi bi-trash-fill mx-1.5 text-[12px]"></i><span class="text-[#6045E2] text-sm">Şəkli sil</span></button>
        </div>
        <div class="allowed-types">
            <p class="text-[12px] text-gray-500">İcazə verilən fayl tipləri: png, jpg, jpeg.</p>
        </div>
    </section>
    <section class="profile-info">
  <form [formGroup]="profileForm" class="flex flex-wrap gap-4">
    <!-- Department -->
    <div class="w-9/20 flex flex-col text-sm gap-y-2">
      <label class="font-semibold text-gray-700 w-full px-1" for="pr_dep">Şöbə</label>
      <input
        (input)="isChanged=true"
        (focus)="isFocused = true"
        (blur)="onBlur()"
        class="px-3 py-2 w-full border border-black/15 rounded-md outline-0 focus:outline-[#6045E2] focus:outline-1 text-gray-500"
        type="text"
        id="pr_dep"
        formControlName="department"
        placeholder="Şöbəni daxil edin" />
    </div>

    <!-- Position -->
    <div class="w-9/20 flex flex-col text-sm gap-y-2">
      <label class="font-semibold text-gray-700 w-full px-1" for="pr_position">Vəzifə</label>
      <input
        (input)="isChanged=true"
        (focus)="isFocused = true"
        (blur)="onBlur()"
        class="px-3 py-2 w-full border border-black/15 rounded-md outline-0 focus:outline-[#6045E2] focus:outline-1 text-gray-500"
        type="text"
        id="pr_position"
        formControlName="position"
        placeholder="Vəzifəni daxil edin" />
    </div>

    <!-- Internal phone -->
    <div class="w-9/20 flex flex-col text-sm gap-y-2">
      <label class="font-semibold text-gray-700 w-full px-1" for="pr_in_tel">Daxili telefon</label>
      <input
        (input)="isChanged=true"
        (focus)="isFocused = true"
        (blur)="onBlur()"
        class="px-3 py-2 w-full border border-black/15 rounded-md outline-0 focus:outline-[#6045E2] focus:outline-1 text-gray-500"
        type="text"
        id="pr_in_tel"
        formControlName="officeTelNumber"
        placeholder="Daxili telefon" />
    </div>

    <!-- Mobile phone -->
    <div class="w-9/20 flex flex-col text-sm gap-y-2">
      <label class="font-semibold text-gray-700 w-full px-1" for="pr_mob_tel">Mobil telefon</label>
      <input
        (input)="isChanged=true"
        (focus)="isFocused = true"
        (blur)="onBlur()"
        class="px-3 py-2 w-full border border-black/15 rounded-md outline-0 focus:outline-[#6045E2] focus:outline-1 text-gray-500"
        type="tel"
        id="pr_mob_tel"
        formControlName="mobTelNumber"
        placeholder="Mobil telefon" />
    </div>

    <!-- Notifications -->
    <div class="w-full flex flex-col items-start text-sm gap-y-3">
      <span class="font-semibold text-gray-700 w-fit px-1">Bildirişə icazə ver</span>
      <label class="switch cursor-pointer px-1">
        <input
            (input)="isChanged=true"
            (focus)="isFocused = true"
            (blur)="onBlur()"           
            type="checkbox"
            formControlName="allowNotification"
        />
        <span class="slider"></span>
    </label>

    </div>

    <!-- Buttons -->
    <div class="w-full flex justify-between text-sm gap-y-2 px-4 font-semibold">
      <a routerLink="/forget-password" class="Change-password flex text-[#6045E2] w-fit gap-x-3 opacity-70 hover:opacity-100">
        <i class="bi  bi-lock"></i>
        <span>Şifrəni dəyiş</span>
      </a>

      <div [ngClass]="isActive? 'opacity-100':'opacity-70'" class="button-group  w-1/2 flex gap-3 justify-end">
        <button
          type="reset"
          [disabled]="!isActive"
          [ngClass]="!isActive?'cursor-no-drop':'cursor-pointer'"
          class="border-1  border-black/15 w-1/5 text-gray-400 py-2 rounded-md"
          (click)="profileForm.reset()">
          Ləğv et
        </button>

        <button
          type="submit"
          [disabled]="!isActive"
          [ngClass]="!isActive? 'cursor-no-drop':'cursor-pointer'"
          class="bg-[#6045E2] w-1/5  transition duration-300 hover:bg-[#806ce1] text-white py-2 rounded-md"
          (click)="onUpdate()">
          @if (!loading) {
            <span>Yenilə</span>
          }
          @if (loading) {
            <div  class="spinner-border spinner-border-sm text-light" role="status"></div>
          } 
          
          
        </button>
      </div>
      
     
     
        

    </div>
  </form>
    @if (successMessage) {
        <div
            class="fixed top-5 left-1/2 transform -translate-x-1/2 bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded shadow-md flex items-center space-x-2 opacity-0 transition-opacity duration-500"
            [ngClass]="{'opacity-100': successMessage, 'opacity-0': !successMessage}">
            <i class="bi bi-check-circle-fill"></i>            
            <span>{{ successMessage }}</span>
        </div>
            
    }
    @if (errorMessage) {
        <div
            class="fixed top-5 left-1/2 transform -translate-x-1/2 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded shadow-md flex items-center space-x-2 opacity-0 transition-opacity duration-500"
            [ngClass]="{'opacity-100': errorMessage, 'opacity-0': !errorMessage}">
            <i class="bi bi-exclamation-octagon-fill"></i>            
            <span>{{ errorMessage }}</span>
        </div>
    }
</section>


</main>